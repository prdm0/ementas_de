---
title: EMENTAS - DE
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: "scroll"
    theme:
      secondary: "#dc3545" 
      bootswatch: sketchy
      version: 4
      font_scale: 1.5
    favicon: "img/logo.png"
    navbar:
      - { icon: "fa-link", href: "https://www.ufpb.br/de", align: right}
      - { icon: "fa-instagram", href: "https://www.instagram.com/estatisticaufpb/", align: right}
      - { icon: "fa-code", href: "https://prdm0.rbind.io/about/", align: right}
runtime: shiny
---

```{r setup, include=FALSE}
options(shiny.autoreload = TRUE)
library(flexdashboard)
library(shiny)
library(dplyr)
library(fontawesome)
library(tippy)
library(rlang)
library(shinyWidgets)
# Install thematic and un-comment for themed static plots (i.e., ggplot2)
# thematic::thematic_rmd()
source("R/codigo_tabela.R")
source("R/parecer.R")
```

# Sobre {data-icon="fa-home"}

Rows {data-width=10}
-------------------------------------

```{r  eval=require('leaflet'), echo = FALSE}
library(leaflet)
df_map <- reactive({leaflet() |>  
  addMarkers(-34.846199, -7.140400) |> 
  leaflet::addTiles() |> 
  setView(
  -34.846199, -7.140400, zoom = 27,
  options = popupOptions(
    minWidth = 30,
    maxWidth = 30
  )
)})
renderLeaflet({df_map()})
```

O Curso de Bacharelado em Estatística, do [Departamento de Estatística](https://www.ufpb.br/de) - DE da [Universidade Federal da Paraíba](https://www.ufpb.br) - UFPB foi criado no ano 2000, a partir da Resolução Nº 25/2000 do CONSEPE (Conselho Superior de Ensino, Pesquisa e Extensão). Desde a primeira turma de formandos em 2004.1, todos os bacharéis em Estatística da UFPB obtiveram postos de trabalho e/ou ingressaram em programas de pós-graduação de comprovado nível de excelência.

A qualificação do corpo docente do Departamento de Estatística tem aumentado desde a criação do Bacharelado, ampliando a participação e engajamento em pesquisas e orientações em programas de Pós-Graduação. Este engajamento culminou com a criação, no Departamento de Estatística, do Programa de Mestrado em Modelos de Decisão e Saúde no ano de 2009, bem como a criação do Programa de Doutorado em Modelos de Decisão e Saúde no ano de 2012.

Dada esta trajetória, o Bacharelado em Estatística tem por compromisso formar competências intelectuais que reflitam a heterogeneidade das demandas sociais em relação a profissionais de alto nível, consoante à inovação presente no inciso II do artigo 43 da LDB.

Nessa aplicação, você poderá ter acesso às lista de conteúdos das ementas das disciplinas fornecidas pelo DE.

**Algumas observação**:

1 - A aplicação ainda não contempla todas as ementas de todas as disciplinas fornecidas pelo DE;

2 - Para acessar os PDF's das ementas do curso do bacharelado, consulte o site do departamento ou clique [**AQUI**](https://www.ufpb.br/de/contents/menu/bacharelado-em-estatistica/bacharelado-em-estatistica);

3 - Para ter acesso às disciplinas de serviço, por favor, entre em contato com a Secretaria do DE.

# Outros cursos {data-navmenu="Pesquisar ementa" data-icon="fa-book-open"}

### Outros cursos {.no-mobile}

<br>

```{r}
#tabela(disciplinas_servico)
textInput(inputId = "value", label = "Disciplina", value = "CPEI")
ementa <- reactive({
  search_all(disciplinas_servico, text = input$value)
})
renderPrint({ementa()})
```

### Outros cursos {.mobile}

<br>

```{r}
#tabela(disciplinas_servico)
textInput(inputId = "value", label = "Disciplina", value = "CPEI")
ementa <- reactive({
  search_all(disciplinas_servico, text = input$value)
})
renderPrint({ementa()})
```

# Bacharelado {data-navmenu="Pesquisar ementa" data-icon="fa-graduation-cap"}

### Bacharelado {.no-mobile}

<br>

```{r}
#tabela(disciplinas_servico)
textInput(inputId = "valueDE", label = "Disciplina", value = "CPEI")
ementaDE <- reactive({
  search_all(disciplinas_de, text = input$valueDE)
})
renderPrint({ementaDE()})
```

### Bacharelado {.mobile}

<br>

```{r}
#tabela(disciplinas_servico)
textInput(inputId = "valueDE", label = "Disciplina", value = "CPEI")
ementaDE <- reactive({
  search_all(disciplinas_de, text = input$valueDE)
})
renderPrint({ementaDE()})
```

# Códigos x Disciplinas {data-navmenu="Pesquisar ementa" data-icon="fa-eye"}

<br> Algumas disciplinas fornecidas pelo Departamento de Estatística possuem o mesmo nome. Sendo assim, faz-se necessário saber o código correto da disciplina que se deseja pesquisar a ementa. A Tabela abaixo lista todas as disciplinas fornecidas pelo departameto, pelos seus respectivos códigos, carga horária e número de créditos.

```{r}
shiny::renderUI({disciplina_codigos()})
```

# Deferido {data-navmenu="Parecer" data-icon="fa-thumbs-up"}

### Deferido {data-navmenu="Parecer"}

#### Discente

```{r}
tippy::with_tippy(
  textInput(inputId = "nomeDE", label = "Nome:", value = ""),
  tooltip = "Informe o nome do discente"
)

tippy::with_tippy(
  textInput(inputId = "matriculaDE", label = "Matrícula:", value = ""),
  tooltip = "Informe a matrícula do discente no vínculo atual com a UFPB"
)

tippy::with_tippy(
  textInput(inputId = "cursoAtualDE", label = "Curso atual:", value = ""),
  tooltip = "Informe o curso atual que o discente cursa na UFPB"
)
```

#### Disciplina a ser dispensada

```{r}
tippy::with_tippy(
  selectInput("disciplinaDE", label = "Código da disiciplina:",
          choices = c(paste("COD: (", disciplina_codigos(is_DT = FALSE)$Códigos, "), ", disciplina_codigos(is_DT = FALSE)$Disciplinas, sep = ""))),
  tooltip = 'Selecione o código da disciplina a ser dispensada. Se não souber o código, basta procurar nessa aplicação, na aba "Pesquisar ementas"'
)
```


#### Outras informações do curso anterior 
```{r}
tippy::with_tippy(
  textInput(inputId = "instituicaoAnteriorDE", label = "Intituição anterior:", value = ""),
  tooltip = "Intorme a disciplina cursada na instituição anterior"
)

tippy::with_tippy(
  textInput(inputId = "cursoAntigo", label = "Curso anterior:", value = ""),
  tooltip = "Informe o curso anterior onde o discente cursou a disciplina a ser utilizada no processo de dispensa"
)

tippy::with_tippy(
  textInput(inputId = "disciplinaCursadaDE", label = "Disciplina cursada:", value = ""),
  tooltip = "Informe a disciplina cursada na instituição anterior. Poderá ser mais de uma. Ex: disciplina 1, disciplina 2 e disciplina 3"
)

tippy::with_tippy(
  textInput(inputId = "anosCursadaDE", label = "Ano:", value = ""),
  tooltip = "Informe o ano em que o discente cursou a disciplina a ser utilizada no processo de dispensa. Poderá ser mais de um. Ex: ano 1, ano 2 e ano 3"
)

output$downloadDE <- downloadHandler(
  filename = "parecer_final_deferido.pdf",
  content = function(file) {
    rmarkdown::render(
      "parecer/modelos/modelo_deferido.Rmd",
      output_file = file,
      params = list(
        nome = input$nomeDE,
        matricula = input$matriculaDE,
        curso_atual = input$cursoAtualDE,
        disciplina_cursada = input$disciplinaCursadaDE,
        instituicao_antiga = input$instituicaoAnteriorDE,
        anos_cursados = input$anosCursadaDE,
        curso_anterior = input$cursoAntigo,
        disciplina = input$disciplinaDE
      ),
      envir = new.env(parent = globalenv())
    )
  }
)

renderUI({
  downloadButton("downloadDE", "Baixe o PDF do parecer", style = "width:100%;")
})

#downloadLink('downloadDE', 'Baixe o PDF do Parecer', icon = shiny::icon("download"))
```

# Indeferido {data-navmenu="Parecer" data-icon="fa-thumbs-down"}

### Indeferido {data-navmenu="Parecer"}

#### Discente 

```{r}
tippy::with_tippy(
  textInput(inputId = "nomeIND", label = "Nome:", value = ""),
  tooltip = "Informe o nome do discente"
)

tippy::with_tippy(
  textInput(inputId = "matriculaIND", label = "Matrícula:", value = ""),
  tooltip = "Informe a matrícula do discente no vínculo atual com a UFPB"
)

tippy::with_tippy(
  textInput(inputId = "cursoAtualIND", label = "Curso atual:", value = ""),
  tooltip = "Informe o curso atual que o discente cursa na UFPB"
)
```

#### Disciplina não dispensada

```{r}
tippy::with_tippy(
  selectInput("disciplinaIND", label = "Código da disiciplina:",
          choices = c(paste("COD: (", disciplina_codigos(is_DT = FALSE)$Códigos, "), ", disciplina_codigos(is_DT = FALSE)$Disciplinas, sep = ""))),
  tooltip = 'Selecione o código da disciplina solicitada para a dispensa pelo discente. Se não souber o código, basta procurar nessa aplicação, na aba "Pesquisar ementas"'
)
```

#### Outras informações do curso anterior 
```{r}
tippy::with_tippy(
  textInput(inputId = "instituicaoAnteriorIND", label = "Intituição anterior:", value = ""),
  tooltip = "Intorme a disciplina cursada na instituição anterior"
)

tippy::with_tippy(
  textInput(inputId = "cursoAntigoIND", label = "Curso anterior:", value = ""),
  tooltip = "Informe o curso anterior onde o discente cursou a disciplina a ser utilizada no processo de dispensa"
)

tippy::with_tippy(
  textInput(inputId = "disciplinaCursadaIND", label = "Disciplina cursada:", value = ""),
  tooltip = "Informe a disciplina cursada na instituição anterior. Poderá ser mais de uma. Ex: disciplina 1, disciplina 2 e disciplina 3"
)

tippy::with_tippy(
  textInput(inputId = "anosCursadaIND", label = "Ano:", value = ""),
  tooltip = "Informe o ano em que o discente cursou a disciplina a ser utilizada no processo de dispensa. Poderá ser mais de um. Ex: ano 1, ano 2 e ano 3"
)

output$downloadIND <- downloadHandler(
  filename = "parecer_final_indeferido.pdf",
  content = function(file) {
    rmarkdown::render(
      "parecer/modelos/modelo_indeferido.Rmd",
      output_file = file,
      params = list(
        nome = input$nomeIND,
        matricula = input$matriculaIND,
        curso_atual = input$cursoAtualIND,
        disciplina_cursada = input$disciplinaCursadaIND,
        instituicao_antiga = input$instituicaoAnteriorIND,
        anos_cursados = input$anosCursadaIND,
        curso_anterior = input$cursoAntigoIND,
        disciplina = input$disciplinaIND
      ),
      envir = new.env(parent = globalenv())
    )
  }
)
renderUI({
  downloadButton("downloadIND", "Baixe o PDF do parecer", style = "width:100%;")
})

# downloadLink('downloadIND', 'Baixe o PDF do Parecer')
```

# Informativo {data-navmenu="Parecer" data-icon="fa-info-circle"}

### Informativo {data-navmenu="Parecer"}


# Contribua com a base {data-icon="fa-database"}

Prezado docente, caso deseje colabora incluindo alguma disciplina ou corrigindo algum erro, baixe o arquivo CSV para fazer as alterações. Após a correção, envie o arquivo CSV alterado para o e-mail [pedro.rafael.marinho\@gmail.com](mailto:pedro.rafael.marinho@gmail.com){.email}.

`r fontawesome::fa(name = "exclamation-triangle", fill = "#dc3545")` **ATENÇÃO**: Não altere o formato do arquivo CSV. Preencha mantendo o mesmo padrão, para que assim, a sugestão possa ser incluída na aplicação.

<br>

```{r}
shiny::renderUI({tabela(ementas)})
```
